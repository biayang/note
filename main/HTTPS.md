# HTTPS

## CA 证书

### 意义
验证HTTPS网站是否可信  
防止中间人攻击  

### 证书链
证书以证书链形式存在。  
最上层为root，即CA，用来颁发证书。  
最下层为end-user，对应每个网站购买使用的证书。  
中间层为intermediates，即二级CA、三级CA...帮助root颁发证书。  

### 证书组成
公钥  :公开  
私钥  :由证书所有者(你的服务器)保管  
签名  :利用**上一层证书的私钥** (即,每个上层证书会对下一层的证书合法性做担保)，加密一些元信息（证书所有者的信息，包括**基本信息**，**公钥**，证书生效域名等）。  
其他  :颁发机构，有效期...  

### 验证流程
1. 当收到签名证书(见[ 证书组成.签名 ])时，只需要根据CA（证书链）提供的公钥对签名解密，验证元信息是否一致，就可以判断当前证书是否合法。 
2. 若网站使用自签名的证书，需要下载安装根证书到用户机器的内置证书中，除非特别信任该机构，否则不要导入很危险。

### 类型
#### DV domain validated 域名验证  
便宜 快捷  
#### OV organization validated 组织验证  
较贵 中速
#### EV extended validated 扩展验证  
最贵 难申请 浏览器显示名称与国家  

### 申请流程
1. 生成客户端(即你的服务器)的密钥，即客户端的公私钥对，且要保证私钥只有客户端自己拥有。
2. 以客户端的密钥和客户端自身的信息(国家、机构、域名、邮箱等)为输入，生成证书请求文件。其中客户端的公钥和客户端信息是明文保存在证书请求文件中的，而客户端私钥的作用是对客户端公钥及客户端信息做签名，自身是不包含在证书请求中的。然后把证书请求文件发送给CA机构。
3. CA机构接收到客户端的证书请求文件后，首先校验其签名，然后审核客户端的信息，最后CA机构使用自己的私钥为证书请求文件签名，生成证书文件，下发给客户端。此证书就是客户端的身份证，来表明用户的身份。
